{% extends "layout.html" %}

{% block title %}
Class Funds
{% endblock %}

{% block onload %}
onload="getOption()"
{% endblock %}

{% block body %}
<div class="container">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, message in messages %}
    <div class="alert {{ category }} d-flex align-items-center">
        <p class="mb-0"><strong>{{ message }}</strong></p>
        {% if category=='alert-success' %}
        <p class="mb-0 ml-auto"><em>Didn't mean to? Click here to undo:</em></p>
        <form action="/undo" method="post" class="ml-2 mr-3" >
            <input type="submit" value="UNDO" name="undo" class="btn btn-xs btn-danger">
        </form>
        {% endif %}
        <button type="button" class="close {% if category!='alert-success' %}ml-auto{% endif %}" data-dismiss="alert">
            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path d="m249 849-42-42 231-231-231-231 42-42 231 231 231-231 42 42-231 231 231 231-42 42-231-231-231 231Z"/></svg>
        </button>
    </div>
    {% endfor %} 
    {% endwith %}
</div>

<div id="mytable">
    <table id="fixed_header" class="table-striped table table-bordered">
        <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Funds</th>
            </tr>
        </thead>
        <tbody>
            {% for fund in funds %}
            <tr>
                <td>{{ fund["id"] }}</td>
                <td>{{ fund["name"] }}</td>
                <td>{{ "${:.2f}".format(fund["funds"]/100) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div class="submission">
    <form action="/funds" method="post" class="form">
        <div class="form-group d-sm-flex">
            <select name="group" id="group" class="custom-select" onchange="getOption()">
                <option disabled selected value="">Select a group</option>
                {% for group in groups %}
                    <option value="{{ group }}">{{ group }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group mr-2" id="indv">
            <select name="indv" class="custom-select">
                <option disabled selected value="">Select a student</option>
                {% for name in names %}
                    <option value="{{ name }}">{{ name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group d-sm-flex">
            <input autocomplete="off" autofocus type="text" name="amt" placeholder="Amount" class="form-control">
        </div>
        <div class="form-group">
            <input type="submit" value="Update Funds" class="btn btn-primary">
        </div>
    </form>
</div>

<div class="clearfix"></div>


<script type="text/javascript">
    function getOption() {
        selectElement = document.querySelector('#group');
        group = selectElement.value;
        x = document.getElementById("indv");
        if (group === "Individual Add" || group === "Individual Subtract") {
            x.style.display = "inline";
            x.style.float = "left";
        } else {
            x.style.display = "none";
        }
    }
</script>
{% endblock %}
